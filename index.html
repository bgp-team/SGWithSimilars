<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup Main Game</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        .required-note {
            color: #666;
            font-size: 13px;
            font-style: italic;
            margin-bottom: 30px;
            text-align: center;
        }
        h2 {
            color: #555;
            font-size: 20px;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-similar {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }
        .section-similar h3 {
            color: #856404;
            margin-top: 0;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }
        label .optional {
            font-weight: normal;
            color: #888;
            font-size: 12px;
            font-style: italic;
        }
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            box-sizing: border-box;
            transition: all 0.3s;
            font-family: inherit;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        input:invalid, textarea:invalid {
            border-color: #dc3545;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        input[type="file"] {
            padding: 8px;
            cursor: pointer;
        }
        .faq-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 3px solid #667eea;
        }
        .faq-item h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #333;
        }
        button[type="submit"] {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        button[type="submit"]:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        button[type="submit"]:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
            font-weight: 500;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .collapsible {
            background: #667eea;
            color: white;
            cursor: pointer;
            padding: 15px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            margin-top: 20px;
            transition: background 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .collapsible:hover {
            background: #5568d3;
        }
        .collapsible:after {
            content: '\002B';
            font-size: 20px;
            font-weight: bold;
        }
        .collapsible.active:after {
            content: "\2212";
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: #f8f9fa;
            border-radius: 0 0 8px 8px;
        }
        .collapsible-content-inner {
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Add Main Game With Similars</h1>
        <p class="required-note">* All required fields must be filled</p>
        
        <form id="gameForm">
            <h2>üìã Main Game Information</h2>
            
            <div class="form-group">
                <label>Game Name *</label>
                <input type="text" id="gameName" required>
            </div>

            <div class="form-group">
                <label>Meta Description *</label>
                <textarea id="metaDescription" required placeholder="Meta description for the game..." style="min-height: 100px;"></textarea>
            </div>

            <div class="form-group">
                <label>Author Name *</label>
                <input type="text" id="authorName" required>
            </div>

            <div class="form-group">
                <label>Iframe URL *</label>
                <input type="url" id="iframeUrl" required placeholder="https://example.com/game">
            </div>

            <div class="form-group">
                <label>Post Content *</label>
                <textarea id="content" required placeholder="Full post content..." style="min-height: 150px;"></textarea>
            </div>

            <h2>üîê Website & Credentials</h2>

            <div class="form-group">
                <label>Website URL *</label>
                <input type="url" id="websiteUrl" required placeholder="https://yourwebsite.com">
            </div>

            <div class="form-group">
                <label>Username *</label>
                <input type="text" id="username" required>
            </div>

            <div class="form-group">
                <label>Password *</label>
                <input type="password" id="password" required>
            </div>

            <h2>üåê Additional URLs</h2>

            <div class="form-group">
                <label>Wikipedia Game URL <span class="optional">(optional)</span></label>
                <input type="url" id="wikipediaGameUrl" placeholder="https://wikipedia.org/wiki/...">
            </div>

            <div class="form-group">
                <label>App Store URL *</label>
                <input type="url" id="appStoreUrl" required placeholder="https://apps.apple.com/...">
            </div>

            <div class="form-group">
                <label>Google Play URL *</label>
                <input type="url" id="googlePlayUrl" required placeholder="https://play.google.com/...">
            </div>

            <h2>üë®‚Äçüíª Developer Information</h2>

            <div class="form-group">
                <label>Developer Name *</label>
                <input type="text" id="developerName" required>
            </div>

            <div class="form-group">
                <label>Wikipedia Developer URL <span class="optional">(optional)</span></label>
                <input type="url" id="wikipediaDeveloperUrl" placeholder="https://wikipedia.org/wiki/...">
            </div>

            <div class="form-group">
                <label>Twitter Developer URL <span class="optional">(optional)</span></label>
                <input type="url" id="twitterDeveloperUrl" placeholder="https://twitter.com/...">
            </div>

            <h2>üñºÔ∏è Main Game Images</h2>

            <div class="form-group">
                <label>Logo Image *</label>
                <input type="file" id="logoImage" accept="image/*" required>
            </div>

            <div class="form-group">
                <label>Favicon Image *</label>
                <input type="file" id="faviconImage" accept="image/*" required>
            </div>

            <div class="form-group">
                <label>Post Image *</label>
                <input type="file" id="postImage" accept="image/*" required>
            </div>

            <div class="form-group">
                <label>Thumbnail Image *</label>
                <input type="file" id="thumbnailImage" accept="image/*" required>
            </div>

            <!-- FAQ MAIN GAME -->
            <button type="button" class="collapsible">‚ùì FAQ Main Game <span class="optional">(optional)</span></button>
            <div class="collapsible-content">
                <div class="collapsible-content-inner">
                    <div class="faq-item">
                        <h3>FAQ 1</h3>
                        <div class="form-group">
                            <label>Question 1 <span class="optional">(optional)</span></label>
                            <input type="text" id="faqQuestion1">
                        </div>
                        <div class="form-group">
                            <label>Answer 1 <span class="optional">(optional)</span></label>
                            <textarea id="faqAnswer1"></textarea>
                        </div>
                    </div>

                    <div class="faq-item">
                        <h3>FAQ 2</h3>
                        <div class="form-group">
                            <label>Question 2 <span class="optional">(optional)</span></label>
                            <input type="text" id="faqQuestion2">
                        </div>
                        <div class="form-group">
                            <label>Answer 2 <span class="optional">(optional)</span></label>
                            <textarea id="faqAnswer2"></textarea>
                        </div>
                    </div>

                    <div class="faq-item">
                        <h3>FAQ 3</h3>
                        <div class="form-group">
                            <label>Question 3 <span class="optional">(optional)</span></label>
                            <input type="text" id="faqQuestion3">
                        </div>
                        <div class="form-group">
                            <label>Answer 3 <span class="optional">(optional)</span></label>
                            <textarea id="faqAnswer3"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIMILAR GAME 1 (Required) -->
            <h2 style="margin-top: 40px;">üéØ Similar Games</h2>
            
            <button type="button" class="collapsible">üéÆ Similar Game 1 *</button>
            <div class="collapsible-content">
                <div class="collapsible-content-inner">
                    <div class="section-similar">
                        <h3>üéÆ Similar Game 1 Details</h3>
                        
                        <div class="form-group">
                            <label>Game Name *</label>
                            <input type="text" id="similarGame1Name" required placeholder="Enter similar game name">
                        </div>

                        <div class="form-group">
                            <label>Meta Description *</label>
                            <textarea id="similarGame1MetaDesc" required placeholder="Meta description..." style="min-height: 100px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label>Iframe URL *</label>
                            <input type="url" id="similarGame1Iframe" required placeholder="https://example.com/game">
                        </div>

                        <div class="form-group">
                            <label>App Store URL *</label>
                            <input type="url" id="similarGame1AppStore" required placeholder="https://apps.apple.com/...">
                        </div>

                        <div class="form-group">
                            <label>Google Play URL *</label>
                            <input type="url" id="similarGame1GooglePlay" required placeholder="https://play.google.com/...">
                        </div>

                        <div class="form-group">
                            <label>Content *</label>
                            <textarea id="similarGame1Content" required placeholder="Game description and content..." style="min-height: 150px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label>Thumbnail Image *</label>
                            <input type="file" id="similarGame1Thumbnail" accept="image/*" required>
                        </div>

                        <div class="form-group">
                            <label>Post Image *</label>
                            <input type="file" id="similarGame1PostImage" accept="image/*" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIMILAR GAME 2 (Required) -->
            <button type="button" class="collapsible">üéÆ Similar Game 2 *</button>
            <div class="collapsible-content">
                <div class="collapsible-content-inner">
                    <div class="section-similar">
                        <h3>üéÆ Similar Game 2 Details</h3>
                        
                        <div class="form-group">
                            <label>Game Name *</label>
                            <input type="text" id="similarGame2Name" required placeholder="Enter similar game name">
                        </div>

                        <div class="form-group">
                            <label>Meta Description *</label>
                            <textarea id="similarGame2MetaDesc" required placeholder="Meta description..." style="min-height: 100px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label>Iframe URL *</label>
                            <input type="url" id="similarGame2Iframe" required placeholder="https://example.com/game">
                        </div>

                        <div class="form-group">
                            <label>App Store URL *</label>
                            <input type="url" id="similarGame2AppStore" required placeholder="https://apps.apple.com/...">
                        </div>

                        <div class="form-group">
                            <label>Google Play URL *</label>
                            <input type="url" id="similarGame2GooglePlay" required placeholder="https://play.google.com/...">
                        </div>

                        <div class="form-group">
                            <label>Content *</label>
                            <textarea id="similarGame2Content" required placeholder="Game description and content..." style="min-height: 150px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label>Thumbnail Image *</label>
                            <input type="file" id="similarGame2Thumbnail" accept="image/*" required>
                        </div>

                        <div class="form-group">
                            <label>Post Image *</label>
                            <input type="file" id="similarGame2PostImage" accept="image/*" required>
                        </div>
                    </div>
                </div>
            </div>

            <button type="submit" id="submitBtn">üöÄ Send Game Data</button>
        </form>

        <div id="message" class="message"></div>
    </div>

    <script>
        // üî• PUT YOUR N8N WEBHOOK URL HERE
        const WEBHOOK_URL = 'https://n8n.srv1053791.hstgr.cloud/webhook/9f2311b6-68bc-4c32-94f1-dd330a1464c8';

        const form = document.getElementById('gameForm');
        const submitBtn = document.getElementById('submitBtn');
        const message = document.getElementById('message');

        // Collapsible sections
        const collapsibles = document.getElementsByClassName("collapsible");
        for (let i = 0; i < collapsibles.length; i++) {
            collapsibles[i].addEventListener("click", function() {
                this.classList.toggle("active");
                const content = this.nextElementSibling;
                if (content.style.maxHeight) {
                    content.style.maxHeight = null;
                } else {
                    content.style.maxHeight = content.scrollHeight + "px";
                }
            });
        }

        // Convert file to Base64
        async function toBase64(file) {
            return new Promise((resolve, reject) => {
                if (!file) return resolve(null);
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
            });
        }

        // Form validation before submit
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // HTML5 validation will prevent submit if required fields are empty
            // This is automatic with the 'required' attribute

            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ Sending...';
            message.style.display = 'none';

            try {
                // Get main game files
                const logoFile = document.getElementById('logoImage').files[0];
                const faviconFile = document.getElementById('faviconImage').files[0];
                const postFile = document.getElementById('postImage').files[0];
                const thumbnailFile = document.getElementById('thumbnailImage').files[0];

                // Get similar game 1 files
                const sg1ThumbnailFile = document.getElementById('similarGame1Thumbnail').files[0];
                const sg1PostFile = document.getElementById('similarGame1PostImage').files[0];

                // Get similar game 2 files
                const sg2ThumbnailFile = document.getElementById('similarGame2Thumbnail').files[0];
                const sg2PostFile = document.getElementById('similarGame2PostImage').files[0];

                // Convert to base64
                const logoBase64 = await toBase64(logoFile);
                const faviconBase64 = await toBase64(faviconFile);
                const postBase64 = await toBase64(postFile);
                const thumbnailBase64 = await toBase64(thumbnailFile);

                const sg1ThumbnailBase64 = await toBase64(sg1ThumbnailFile);
                const sg1PostBase64 = await toBase64(sg1PostFile);

                const sg2ThumbnailBase64 = await toBase64(sg2ThumbnailFile);
                const sg2PostBase64 = await toBase64(sg2PostFile);

                // Build FAQ array
                const faqItems = [];
                for (let i = 1; i <= 3; i++) {
                    const question = document.getElementById(`faqQuestion${i}`).value.trim();
                    const answer = document.getElementById(`faqAnswer${i}`).value.trim();
                    
                    if (question && answer) {
                        faqItems.push({ question, answer });
                    }
                }

                // Build Similar Game 1 object (required)
                const similarGame1 = {
                    gameName: document.getElementById('similarGame1Name').value,
                    metaDescription: document.getElementById('similarGame1MetaDesc').value,
                    iframeUrl: document.getElementById('similarGame1Iframe').value,
                    appStoreUrl: document.getElementById('similarGame1AppStore').value,
                    googlePlayUrl: document.getElementById('similarGame1GooglePlay').value,
                    content: document.getElementById('similarGame1Content').value,
                    thumbnailImage: sg1ThumbnailBase64,
                    postImage: sg1PostBase64
                };

                // Build Similar Game 2 object (required)
                const similarGame2 = {
                    gameName: document.getElementById('similarGame2Name').value,
                    metaDescription: document.getElementById('similarGame2MetaDesc').value,
                    iframeUrl: document.getElementById('similarGame2Iframe').value,
                    appStoreUrl: document.getElementById('similarGame2AppStore').value,
                    googlePlayUrl: document.getElementById('similarGame2GooglePlay').value,
                    content: document.getElementById('similarGame2Content').value,
                    thumbnailImage: sg2ThumbnailBase64,
                    postImage: sg2PostBase64
                };

                // Build JSON payload
                const payload = {
                    gameName: document.getElementById('gameName').value,
                    metaDescription: document.getElementById('metaDescription').value,
                    authorName: document.getElementById('authorName').value,
                    iframeUrl: document.getElementById('iframeUrl').value,
                    websiteUrl: document.getElementById('websiteUrl').value,
                    wikipediaGameUrl: document.getElementById('wikipediaGameUrl').value || null,
                    appStoreUrl: document.getElementById('appStoreUrl').value,
                    googlePlayUrl: document.getElementById('googlePlayUrl').value,
                    developerName: document.getElementById('developerName').value,
                    wikipediaDeveloperUrl: document.getElementById('wikipediaDeveloperUrl').value || null,
                    twitterDeveloperUrl: document.getElementById('twitterDeveloperUrl').value || null,
                    username: document.getElementById('username').value,
                    password: document.getElementById('password').value,
                    content: document.getElementById('content').value,
                    logoImage: logoBase64,
                    faviconImage: faviconBase64,
                    postImage: postBase64,
                    thumbnailImage: thumbnailBase64,
                    similarGame1: similarGame1,
                    similarGame2: similarGame2,
                    faq: faqItems.length > 0 ? faqItems : null,
                    triggered_by: 'client',
                    timestamp: new Date().toISOString()
                };

                // Send JSON to n8n
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    showMessage('‚úÖ Game sent successfully!', 'success');
                    form.reset();
                    // Clear file inputs
                    ['logoImage','faviconImage','postImage','thumbnailImage',
                     'similarGame1Thumbnail','similarGame1PostImage',
                     'similarGame2Thumbnail','similarGame2PostImage'].forEach(id => {
                        const el = document.getElementById(id);
                        if (el) el.value = '';
                    });
                    // Close all collapsible sections
                    for (let i = 0; i < collapsibles.length; i++) {
                        collapsibles[i].classList.remove("active");
                        collapsibles[i].nextElementSibling.style.maxHeight = null;
                    }
                } else {
                    throw new Error('Error while sending');
                }
            } catch (error) {
                showMessage('‚ùå Error: ' + error.message, 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'üöÄ Send Game Data';
            }
        });

        function showMessage(text, type) {
            message.textContent = text;
            message.className = 'message ' + type;
            message.style.display = 'block';
            
            setTimeout(() => {
                message.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>
